---
import '../../styles/global.css';
import { AstroSeo } from '@astrolib/seo';
import { userConfig } from '../../config/index';

// Build safe defaults for SEO
const siteOrigin = Astro.site ? new URL('/', Astro.site).origin : undefined;
const canonicalUrl = Astro.props.canonical || siteOrigin;
const ogUrl = Astro.props.openGraph?.url || siteOrigin;
---

<!-- Core meta tags -->
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<meta name="author" content={userConfig.name} />

<!-- SEO Configuration -->
<AstroSeo
  title={Astro.props.title || userConfig.seo.title}
  description={Astro.props.description || userConfig.seo.description}
  canonical={canonicalUrl}
  openGraph={{
    url: ogUrl,
    title: Astro.props.openGraph?.title || userConfig.seo.title,
    description: Astro.props.openGraph?.description || userConfig.seo.description,
    site_name: Astro.props.openGraph?.site_name || userConfig.name,
  }}
  twitter={{
    cardType: 'summary_large_image',
  }}
/>

<!-- JSON-LD Schema.org -->
{
  siteOrigin && (
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'WebSite',
        url: siteOrigin,
        name: userConfig.name,
        description: userConfig.seo.description,
      })}
    />
  )
}
{
  siteOrigin && (
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'Person',
        name: userConfig.name,
        jobTitle: userConfig.role,
        url: siteOrigin,
        sameAs: [userConfig.social.github, userConfig.social.linkedin].filter(Boolean),
      })}
    />
  )
}

<!-- Add your favicon files in public/images/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/images/dg-labs.svg" />
<link rel="icon" type="image/svg+xml" href="/images/dg-labs.svg" />
<link rel="icon" type="image/svg+xml" href="/images/dg-labs.svg" />

<!-- Theme colors for browsers -->
<meta name="msapplication-TileColor" content={userConfig.theme.secondaryColor} />
<meta name="theme-color" content={userConfig.theme.secondaryColor} />

<!-- Auto-generated sitemap -->
<link rel="sitemap" href="/sitemap-index.xml" />
